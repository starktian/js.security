function hex_sha1(a){return binb2hex(core_sha1(AlignSHA1(a)))}function sha1_vm_test(){return"a9993e364706816aba3e25717850c26c9cd0d89d"==hex_sha1("abc")}function core_sha1(a){for(var e=a,r=Array(80),n=1732584193,t=-271733879,s=-1732584194,c=271733878,d=-1009589776,f=0;f<e.length;f+=16){for(var o=n,u=t,h=s,_=c,i=d,l=0;l<80;l++){l<16?r[l]=e[f+l]:r[l]=rol(r[l-3]^r[l-8]^r[l-14]^r[l-16],1);var g=safe_add(safe_add(rol(n,5),sha1_ft(l,t,s,c)),safe_add(safe_add(d,r[l]),sha1_kt(l)));d=c,c=s,s=rol(t,30),t=n,n=g}n=safe_add(n,o),t=safe_add(t,u),s=safe_add(s,h),c=safe_add(c,_),d=safe_add(d,i)}return new Array(n,t,s,c,d)}function sha1_ft(a,e,r,n){return a<20?e&r|~e&n:a<40?e^r^n:a<60?e&r|e&n|r&n:e^r^n}function sha1_kt(a){return a<20?1518500249:a<40?1859775393:a<60?-1894007588:-899497514}function safe_add(a,e){var r=(65535&a)+(65535&e),n=(a>>16)+(e>>16)+(r>>16);return n<<16|65535&r}function rol(a,e){return a<<e|a>>>32-e}function AlignSHA1(a){for(var e=(a.length+8>>6)+1,r=new Array(16*e),n=0;n<16*e;n++)r[n]=0;for(n=0;n<a.length;n++)r[n>>2]|=a.charCodeAt(n)<<24-8*(3&n);return r[n>>2]|=128<<24-8*(3&n),r[16*e-1]=8*a.length,r}function binb2hex(a){for(var e=hexcase?"0123456789ABCDEF":"0123456789abcdef",r="",n=0;n<4*a.length;n++)r+=e.charAt(a[n>>2]>>8*(3-n%4)+4&15)+e.charAt(a[n>>2]>>8*(3-n%4)&15);return r}function calcDigest(){var a=hex_sha1(document.SHAForm.SourceMessage.value);document.SHAForm.MessageDigest.value=a}function debug(){alert("debug message")}var hexcase=0,chrsz=8;